 gblur←{
     ⎕IO←0
     l rad←⍺
     m←(⍴⍵)⍴1
     box←{⍵÷⍥({+/,⍵}⌺⍺ ⍺)m}
     bforg←{
         wl←(⊢-0=2|⊢)⌊0.5*⍨1+⍺÷⍨i←12×⍵*2
         m←⌊0.5+(i-+/(wl*2 1 0)×1 4 3×⍺)÷¯4×1+wl
         wl+2×m≤⍳⍺
     }
     ⌊⊃box/(l bforg rad),⊂⍵
 }
