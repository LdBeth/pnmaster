 cielab←{
     ⎕IO←1
     d←⍉0.950456 1 1.088754÷⍨⍤1⊢RGB2XYZ+.×⍤99 1⊢⍉⍵÷255
     m←d>3*⍨6÷29
     d←((~m)×(4÷29)+⍵÷3×2*⍨6÷29)+m×d*÷3
     (⍴⍵)⍴(16-⍨116×2⌷d)⍪(500×(1⌷d)-2⌷d)⍪200×(2⌷d)-3⌷d
 }
