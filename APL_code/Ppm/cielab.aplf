 cielab←{
     ⎕IO←1
     d←⍉D65÷⍨⍤1⊢RGB2XYZ+.×⍤99 1⊢⍉⍵÷255
     m←d>3*⍨6÷29
     y←2⌷xyz←m×d*÷3
     d←((~m)×(4÷29)+⍵÷3×2*⍨6÷29)+xyz
     (⍴⍵)⍴((903.3×(2⌷d)×~2⌷m)+(2⌷m)×16-⍨116×y)⍪(500×(1⌷d)-2⌷d)⍪200×(2⌷d)-3⌷d
 }
